<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="BINOLSTCM08">
	<sql id="insertProductInDepotKey">
		<dynamic>
			<isNotEmpty property="BillNo">
				BillNo,
			</isNotEmpty>
			<isNotEmpty property="BillNoIF">
				BillNoIF,
			</isNotEmpty>
			<isNotEmpty property="RelevanceNo">
				RelevanceNo,
			</isNotEmpty>
			<isNotEmpty property="ImportBatch">
				ImportBatch,
			</isNotEmpty>
			<isNotEmpty property="BIN_BussinessPartnerID">
				BIN_BussinessPartnerID,
			</isNotEmpty>
			<isNotEmpty property="BIN_EmployeeID">
				BIN_EmployeeID,
			</isNotEmpty>
			<isNotEmpty property="BIN_OrganizationIDDX">
				BIN_OrganizationIDDX,
			</isNotEmpty>
			<isNotEmpty property="BIN_EmployeeIDDX">
				BIN_EmployeeIDDX,
			</isNotEmpty>
			<isNotEmpty property="BIN_EmployeeIDAudit">
				BIN_EmployeeIDAudit,
			</isNotEmpty>
			<isNotEmpty property="TotalQuantity">
				TotalQuantity,
			</isNotEmpty>
			<isNotEmpty property="TotalAmount">
				TotalAmount,
			</isNotEmpty>
			<isNotEmpty property="PreTotalQuantity">
				PreTotalQuantity,
			</isNotEmpty>
			<isNotEmpty property="PreTotalAmount">
				PreTotalAmount,
			</isNotEmpty>
			<isNotEmpty property="BIN_LogisticInfoID">
				BIN_LogisticInfoID,
			</isNotEmpty>
			<isNotEmpty property="Comments">
				Comments,
			</isNotEmpty>
			<isNotEmpty property="InDepotDate">
				InDepotDate,
			</isNotEmpty>
			<isNotEmpty property="VerifiedFlag">
				VerifiedFlag,
			</isNotEmpty>
			<isNotEmpty property="TradeStatus">
				TradeStatus,
			</isNotEmpty>
			<isNotEmpty property="WorkFlowID">
				WorkFlowID,
			</isNotEmpty>
			<isNotEmpty property="SynchFlag">
				SynchFlag,
			</isNotEmpty>
		</dynamic>
	</sql>
	<sql id="insertProductInDepotValue">
		<dynamic>
			<isNotEmpty property="BillNo">
				#BillNo#,
			</isNotEmpty>
			<isNotEmpty property="BillNoIF">
				#BillNoIF#,
			</isNotEmpty>
			<isNotEmpty property="RelevanceNo">
				#RelevanceNo#,
			</isNotEmpty>
			<isNotEmpty property="ImportBatch">
				#ImportBatch#,
			</isNotEmpty>
			<isNotEmpty property="BIN_BussinessPartnerID">
				#BIN_BussinessPartnerID#,
			</isNotEmpty>
			<isNotEmpty property="BIN_EmployeeID">
				#BIN_EmployeeID#,
			</isNotEmpty>
			<isNotEmpty property="BIN_OrganizationIDDX">
				#BIN_OrganizationIDDX#,
			</isNotEmpty>
			<isNotEmpty property="BIN_EmployeeIDDX">
				#BIN_EmployeeIDDX#,
			</isNotEmpty>
			<isNotEmpty property="BIN_EmployeeIDAudit">
				#BIN_EmployeeIDAudit#,
			</isNotEmpty>
			<isNotEmpty property="TotalQuantity">
				#TotalQuantity#,
			</isNotEmpty>
			<isNotEmpty property="TotalAmount">
				#TotalAmount#,
			</isNotEmpty>
			<isNotEmpty property="PreTotalQuantity">
				#PreTotalQuantity#,
			</isNotEmpty>
			<isNotEmpty property="PreTotalAmount">
				#PreTotalAmount#,
			</isNotEmpty>
			<isNotEmpty property="BIN_LogisticInfoID">
				#BIN_LogisticInfoID#,
			</isNotEmpty>
			<isNotEmpty property="Comments">
				#Comments#,
			</isNotEmpty>
			<isNotEmpty property="InDepotDate">
				#InDepotDate#,
			</isNotEmpty>
			<isNotEmpty property="VerifiedFlag">
				#VerifiedFlag#,
			</isNotEmpty>
			<isNotEmpty property="TradeStatus">
				#TradeStatus#,
			</isNotEmpty>
			<isNotEmpty property="WorkFlowID">
				#WorkFlowID#,
			</isNotEmpty>
			<isNotEmpty property="SynchFlag">
				#SynchFlag#,
			</isNotEmpty>
		</dynamic>
	</sql>
	<sql id="insertProductInDepotKeyForMQ">
		<dynamic>
			<isNotEmpty property="tradeNoIF">
				BillNo,
				BillNoIF,
			</isNotEmpty>
			<isNotEmpty property="relevanceNo">
				RelevanceNo,
			</isNotEmpty>
			<isNotEmpty property="importBatch">
				ImportBatch,
			</isNotEmpty>
			<isNotEmpty property="bussinessPartnerID">
				BIN_BussinessPartnerID,
			</isNotEmpty>
			<isNotEmpty property="employeeID">
				BIN_EmployeeID,
			</isNotEmpty>
			<isNotEmpty property="organizationIDDX">
				BIN_OrganizationIDDX,
			</isNotEmpty>
			<isNotEmpty property="employeeIDDX">
				BIN_EmployeeIDDX,
			</isNotEmpty>
			<isNotEmpty property="employeeIDAudit">
				BIN_EmployeeIDAudit,
			</isNotEmpty>
			<isNotEmpty property="totalQuantity">
				TotalQuantity,
			</isNotEmpty>
			<isNotEmpty property="totalAmount">
				TotalAmount,
			</isNotEmpty>
			<isNotEmpty property="preTotalQuantity">
				PreTotalQuantity,
			</isNotEmpty>
			<isNotEmpty property="preTotalAmount">
				PreTotalAmount,
			</isNotEmpty>
			<isNotEmpty property="logisticInfoID">
				BIN_LogisticInfoID,
			</isNotEmpty>
			<isNotEmpty property="comments">
				Comments,
			</isNotEmpty>
			<isNotEmpty property="inDepotDate">
				InDepotDate,
			</isNotEmpty>
			<isNotEmpty property="verifiedFlag">
				VerifiedFlag,
			</isNotEmpty>
			<isNotEmpty property="tradeStatus">
				TradeStatus,
			</isNotEmpty>
			<isNotEmpty property="workFlowID">
				WorkFlowID,
			</isNotEmpty>
			<isNotEmpty property="synchFlag">
				SynchFlag,
			</isNotEmpty>
		</dynamic>
	</sql>
	<sql id="insertProductInDepotValueForMQ">
		<dynamic>
			<isNotEmpty property="tradeNoIF">
				#tradeNoIF#,
				#tradeNoIF#,
			</isNotEmpty>
			<isNotEmpty property="relevanceNo">
				#relevanceNo#,
			</isNotEmpty>
			<isNotEmpty property="importBatch">
				#importBatch#,
			</isNotEmpty>
			<isNotEmpty property="bussinessPartnerID">
				#bussinessPartnerID#,
			</isNotEmpty>
			<isNotEmpty property="employeeID">
				#employeeID#,
			</isNotEmpty>
			<isNotEmpty property="organizationIDDX">
				#organizationIDDX#,
			</isNotEmpty>
			<isNotEmpty property="employeeIDDX">
				#employeeIDDX#,
			</isNotEmpty>
			<isNotEmpty property="employeeIDAudit">
				#employeeIDAudit#,
			</isNotEmpty>
			<isNotEmpty property="totalQuantity">
				#totalQuantity#,
			</isNotEmpty>
			<isNotEmpty property="totalAmount">
				#totalAmount#,
			</isNotEmpty>
			<isNotEmpty property="preTotalQuantity">
				#preTotalQuantity#,
			</isNotEmpty>
			<isNotEmpty property="preTotalAmount">
				#preTotalAmount#,
			</isNotEmpty>
			<isNotEmpty property="logisticInfoID">
				#logisticInfoID#,
			</isNotEmpty>
			<isNotEmpty property="comments">
				#comments#,
			</isNotEmpty>
			<isNotEmpty property="inDepotDate">
				#inDepotDate#,
			</isNotEmpty>
			<isNotEmpty property="verifiedFlag">
				#verifiedFlag#,
			</isNotEmpty>
			<isNotEmpty property="tradeStatus">
				#tradeStatus#,
			</isNotEmpty>
			<isNotEmpty property="workFlowID">
				#workFlowID#,
			</isNotEmpty>
			<isNotEmpty property="synchFlag">
				#synchFlag#,
			</isNotEmpty>
		</dynamic>
	</sql>
	<!--往产品入库主表中插入数据并返回记录ID-->
	<insert id="insertProductInDepot" parameterClass="java.util.HashMap">
		<selectKey resultClass="java.lang.Integer" type="post" keyProperty="BIN_ProductInDepotID" >
			<![CDATA[
		INSERT INTO Inventory.BIN_ProductInDepot(
		        BIN_OrganizationInfoID,
		        BIN_BrandInfoID,
		        BIN_OrganizationID,
		    	]]>
			<include refid="insertProductInDepotKey" />
			<![CDATA[
				CreateTime,
				UpdateTime,
				CreatedBy,
				CreatePGM,
				UpdatedBy,
				UpdatePGM,
				ValidFlag,
				ModifyCount
		 )
		VALUES
			(
				#BIN_OrganizationInfoID#,
				#BIN_BrandInfoID#,
				#BIN_OrganizationID#,
				]]>
			<include refid="insertProductInDepotValue" />
			<![CDATA[
				GETDATE(),
				GETDATE(),
				#CreatedBy#,
				#CreatePGM#,
				#UpdatedBy#,
				#UpdatePGM#,
				'1',
				0
			)
			  	SELECT SCOPE_IDENTITY() AS value
			]]>
		</selectKey>
	</insert>

	<!--往产品入库主表中插入数据并返回记录ID-->
	<insert id="insertProductInDepotForMQ" parameterClass="java.util.HashMap">
		<selectKey resultClass="java.lang.Integer" type="post" keyProperty="BIN_ProductInDepotID" >
			<![CDATA[
		INSERT INTO Inventory.BIN_ProductInDepot(
		        BIN_OrganizationInfoID,
		        BIN_BrandInfoID,
		        BIN_OrganizationID,
		    	]]>
			<include refid="insertProductInDepotKeyForMQ" />
			<![CDATA[
				CreateTime,
				UpdateTime,
				CreatedBy,
				CreatePGM,
				UpdatedBy,
				UpdatePGM,
				ValidFlag,
				ModifyCount
		 )
		VALUES
			(
				#organizationInfoID#,
				#brandInfoID#,
				#organizationID#,
				]]>
			<include refid="insertProductInDepotValueForMQ" />
			<![CDATA[
				GETDATE(),
				GETDATE(),
				#CreatedBy#,
				#CreatePGM#,
				#UpdatedBy#,
				#UpdatePGM#,
				'1',
				0
			)
			  	SELECT SCOPE_IDENTITY() AS value
			]]>
		</selectKey>
	</insert>

	<insert id="insertProductInDepotDetail" parameterClass="java.util.HashMap">
		<![CDATA[
		INSERT INTO Inventory.BIN_ProductInDepotDetail (
		      BIN_ProductInDepotID,
		      BIN_ProductVendorID,
		      DetailNo,
			  BIN_InventoryInfoID,
			  ]]>
		<dynamic>
			<isNotEmpty property="BIN_ProductBatchID">
				BIN_ProductBatchID,
			</isNotEmpty>
			<isNotEmpty property="Quantity">
				Quantity,
			</isNotEmpty>
			<isNotEmpty property="PreQuantity">
				PreQuantity,
			</isNotEmpty>
			<isNotEmpty property="Price">
				Price,
			</isNotEmpty>
			<isNotEmpty property="ReferencePrice">
				ReferencePrice,
			</isNotEmpty>
			<isNotEmpty property="BIN_ProductVendorPackageID">
				BIN_ProductVendorPackageID 	,
			</isNotEmpty>
			<isNotEmpty property="BIN_LogicInventoryInfoID">
				BIN_LogicInventoryInfoID,
			</isNotEmpty>
			<isNotEmpty property="BIN_StorageLocationInfoID">
				BIN_StorageLocationInfoID,
			</isNotEmpty>
			<isNotEmpty property="Comments">
				Comments,
			</isNotEmpty>
		</dynamic>
		<![CDATA[
		      CreateTime,
		      CreatedBy,
		      CreatePGM ,
		      UpdateTime,
		      UpdatedBy,
		      UpdatePGM,
			  ValidFlag ,
		      ModifyCount
			  )
	    VALUES(
		      #BIN_ProductInDepotID#,
		      #BIN_ProductVendorID#,
		      #DetailNo#,
		      #BIN_InventoryInfoID#,
		]]>
		<dynamic>
			<isNotEmpty property="BIN_ProductBatchID">
				#BIN_ProductBatchID#,
			</isNotEmpty>
			<isNotEmpty property="Quantity">
				#Quantity#,
			</isNotEmpty>
			<isNotEmpty property="PreQuantity">
				#PreQuantity#,
			</isNotEmpty>
			<isNotEmpty property="Price">
				#Price#,
			</isNotEmpty>
			<isNotEmpty property="ReferencePrice">
				#ReferencePrice#,
			</isNotEmpty>
			<isNotEmpty property="BIN_ProductVendorPackageID">
				#BIN_ProductVendorPackageID#,
			</isNotEmpty>
			<isNotEmpty property="BIN_LogicInventoryInfoID">
				#BIN_LogicInventoryInfoID#,
			</isNotEmpty>
			<isNotEmpty property="BIN_StorageLocationInfoID">
				#BIN_StorageLocationInfoID#,
			</isNotEmpty>
			<isNotEmpty property="Comments">
				#Comments#,
			</isNotEmpty>
		</dynamic>
		<![CDATA[
		      	GETDATE(),
				#CreatedBy#,
				#CreatePGM#,
				GETDATE(),
				#UpdatedBy#,
				#UpdatePGM#,
				'1',
				0	 
		)
	  ]]>
	</insert>

	<insert id="insertProductInDepotDetailForMQ" parameterClass="java.util.HashMap">
		<![CDATA[
		INSERT INTO Inventory.BIN_ProductInDepotDetail (
		      BIN_ProductInDepotID,
		      BIN_ProductVendorID,
		      DetailNo,
			  BIN_InventoryInfoID,
			  ]]>
		<dynamic>
			<isNotEmpty property="productBatchID">
				BIN_ProductBatchID,
			</isNotEmpty>
			<isNotEmpty property="quantity">
				Quantity,
			</isNotEmpty>
			<isNotEmpty property="quantity">
				PreQuantity,
			</isNotEmpty>
			<isNotEmpty property="price">
				Price,
			</isNotEmpty>
			<isNotEmpty property="referencePrice">
				ReferencePrice,
			</isNotEmpty>
			<isNotEmpty property="productVendorPackageID">
				BIN_ProductVendorPackageID 	,
			</isNotEmpty>
			<isNotEmpty property="logicInventoryInfoID">
				BIN_LogicInventoryInfoID,
			</isNotEmpty>
			<isNotEmpty property="storageLocationInfoID">
				BIN_StorageLocationInfoID,
			</isNotEmpty>
			<isNotEmpty property="comments">
				Comments,
			</isNotEmpty>
		</dynamic>
		<![CDATA[
		      CreateTime,
		      CreatedBy,
		      CreatePGM ,
		      UpdateTime,
		      UpdatedBy,
		      UpdatePGM,
			  ValidFlag ,
		      ModifyCount
			  )
	    VALUES(
		      #productInDepotID#,
		      #productVendorID#,
		      #detailNo#,
		      #inventoryInfoID#,
		]]>
		<dynamic>
			<isNotEmpty property="productBatchID">
				#productBatchID#,
			</isNotEmpty>
			<isNotEmpty property="quantity">
				#quantity#,
			</isNotEmpty>
			<isNotEmpty property="quantity">
				#quantity#,
			</isNotEmpty>
			<isNotEmpty property="price">
				#price#,
			</isNotEmpty>
			<isNotEmpty property="referencePrice">
				#referencePrice#,
			</isNotEmpty>
			<isNotEmpty property="productVendorPackageID">
				#productVendorPackageID#,
			</isNotEmpty>
			<isNotEmpty property="logicInventoryInfoID">
				#logicInventoryInfoID#,
			</isNotEmpty>
			<isNotEmpty property="storageLocationInfoID">
				#storageLocationInfoID#,
			</isNotEmpty>
			<isNotEmpty property="comments">
				#comments#,
			</isNotEmpty>
		</dynamic>
		<![CDATA[
		      	GETDATE(),
				#CreatedBy#,
				#CreatePGM#,
				GETDATE(),
				#UpdatedBy#,
				#UpdatePGM#,
				'1',
				0
		)
	  ]]>
	</insert>
	<!--修改入库主表-->
	<update id="updateProductInDepotMain" parameterClass="java.util.HashMap">
		<![CDATA[
			UPDATE									
				Inventory.BIN_ProductInDepot						
			SET 
			]]>
		<isNotEmpty property="ValidFlag">
			ValidFlag = #ValidFlag#,
		</isNotEmpty>
		<isNotEmpty property="TotalQuantity">
			TotalQuantity = #TotalQuantity#,
		</isNotEmpty>
		<isNotEmpty property="TotalAmount">
			TotalAmount = #TotalAmount#,
		</isNotEmpty>
		<isNotEmpty property="PreTotalQuantity">
			PreTotalQuantity = #PreTotalQuantity#,
		</isNotEmpty>
		<isNotEmpty property="PreTotalAmount">
			PreTotalAmount = #PreTotalAmount#,
		</isNotEmpty>
		<isNotEmpty property="WorkFlowID">
			WorkFlowID = #WorkFlowID#,
		</isNotEmpty>
		<isNotEmpty property="VerifiedFlag">
			VerifiedFlag = #VerifiedFlag#,
		</isNotEmpty>
		<isNotEmpty property="TradeStatus">
			TradeStatus = #TradeStatus#,
		</isNotEmpty>
		<isNotEmpty property="BIN_EmployeeIDAudit">
			BIN_EmployeeIDAudit = #BIN_EmployeeIDAudit#,
		</isNotEmpty>
		<isNotEmpty property="InDepotDate">
			InDepotDate = #InDepotDate#,
		</isNotEmpty>
		<isNotEmpty property="RelevanceNo">
			RelevanceNo = #RelevanceNo#,
		</isNotEmpty>
		<isNotEmpty property="SynchFlag">
			SynchFlag = #SynchFlag#,
		</isNotEmpty>
		<![CDATA[
				UpdateTime=GETDATE(),
				UpdatedBy=#UpdatedBy#,
				UpdatePGM=#UpdatePGM#,
				ModifyCount=ModifyCount+1								
			WHERE									
				BIN_ProductInDepotID = #BIN_ProductInDepotID#
			]]>
		<isNotEmpty property="OldValidFlag">
			AND	ValidFlag = #OldValidFlag#
		</isNotEmpty>
		<isNotEmpty property="OldUpdateTime">
			AND	UpdateTime = #OldUpdateTime#
		</isNotEmpty>
		<isNotEmpty property="OldModifyCount">
			AND	ModifyCount = #OldModifyCount#
		</isNotEmpty>
	</update>
	<!--取得入库信息-->
	<select id="getProductInDepotMainData" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		<![CDATA[
		SELECT
			A.BIN_OrganizationInfoID,
			A.BillNo,
			A.BillNoIF,
			A.RelevanceNo,
			A.ImportBatch,
			A.BIN_BrandInfoID,
			A.BIN_BussinessPartnerID,
			A.BIN_EmployeeID,
			A.BIN_OrganizationIDDX,
			A.BIN_EmployeeIDDX,
			A.BIN_EmployeeIDAudit,
			A.BIN_LogisticInfoID,
			A.BIN_OrganizationID,
			A.BIN_ProductInDepotID,
			A.Comments,
			A.InDepotDate,
			A.TotalAmount,
			A.TotalQuantity,
			A.PreTotalQuantity,
			A.PreTotalAmount,
			A.VerifiedFlag,
			A.TradeStatus,
			A.WorkFlowID,
			A.BIN_EmployeeID,
			A.ModifyCount,
			CONVERT(VARCHAR(30),A.UpdateTime,121) AS UpdateTime,
			B.DepartCode,
			C.Code AS PartnerCode,
			D.EmployeeCode,
			E.EmployeeCode AS AuditCode,
		]]>
		<isNotEmpty property="language">
			<isEqual property="language" compareValue="en_US">
				<![CDATA[
	                    B.NameForeign AS DepartName,
						C.NameEN AS PartnerName,
						D.EmployeeNameForeign AS EmployeeName,
						E.EmployeeNameForeign AS EmployeeAuditName
					]]>
			</isEqual>
			<isEqual property="language" compareValue="zh_CN">
				<![CDATA[
	                    B.DepartName AS DepartName,
						C.NameCN AS PartnerName,
						D.EmployeeName AS EmployeeName,
						E.EmployeeName AS EmployeeAuditName
					]]>
			</isEqual>
		</isNotEmpty>
		<isEmpty property="language">
			<![CDATA[
	                B.DepartName AS DepartName,
					C.NameCN AS PartnerName,
					D.EmployeeName AS EmployeeName,
					E.EmployeeName AS EmployeeAuditName
				]]>
		</isEmpty>
		<![CDATA[
		FROM
			Inventory.BIN_ProductInDepot A
			LEFT JOIN Basis.BIN_Organization B
			ON(A.BIN_OrganizationID = B.BIN_OrganizationID)
			LEFT JOIN Basis.BIN_BussinessPartner C
			ON(A.BIN_BussinessPartnerID = C.BIN_BussinessPartnerID)
			LEFT JOIN Basis.BIN_Employee D
			ON(A.BIN_EmployeeID = D.BIN_EmployeeID)
			LEFT JOIN Basis.BIN_Employee E
			ON(A.BIN_EmployeeIDAudit = E.BIN_EmployeeID)
		WHERE
			A.BIN_ProductInDepotID = #BIN_ProductInDepotID#
		]]>
	</select>
	<!--取得入库明细信息-->
	<select id="getProductInDepotDetailData" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		<![CDATA[
		SELECT
			A.BIN_ProductInDepotDetailID,
			A.BIN_ProductInDepotID,
			A.BIN_ProductVendorID,
			A.BIN_ProductBatchID,
			A.DetailNo,
			A.Quantity,
			A.PreQuantity,
			Convert(decimal(16,2),ISNULL(A.Price, 0)) AS Price,
			Convert(decimal(16,2),ISNULL(A.ReferencePrice, 0)) AS ReferencePrice,
			A.BIN_ProductVendorPackageID,
			A.BIN_InventoryInfoID,
			A.BIN_LogicInventoryInfoID,
			A.BIN_StorageLocationInfoID,
			A.Comments,
			A.ModifyCount,
			A.UpdateTime,
			B.BarCode,
			C.UnitCode,
			E.DepotCode,
			F.LogicInventoryCode,
			G.BatchNo,
			]]>
		<isNotEmpty property="language">
			<isEqual property="language" compareValue="en_US">
				<![CDATA[
	                    C.NameForeign AS ProductName,
						E.DepotNameEN AS DepotName,
						F.InventoryNameEN AS LogicInventoryName
					]]>
			</isEqual>
			<isEqual property="language" compareValue="zh_CN">
				<![CDATA[
	                    C.NameTotal AS ProductName,
						E.DepotNameCN AS DepotName,
						F.InventoryNameCN AS LogicInventoryName
					]]>
			</isEqual>
		</isNotEmpty>
		<isEmpty property="language">
			<![CDATA[
	                C.NameTotal AS ProductName,
					E.DepotNameCN AS DepotName,
					F.InventoryNameCN AS LogicInventoryName
				]]>
		</isEmpty>
		<![CDATA[
		FROM
			Inventory.BIN_ProductInDepotDetail A
			LEFT JOIN Basis.BIN_ProductVendor B
			ON(A.BIN_ProductVendorID = B.BIN_ProductVendorID)
			LEFT JOIN Basis.BIN_Product C
			ON(B.BIN_ProductID = C.BIN_ProductID)
			LEFT JOIN Basis.BIN_DepotInfo E
			ON(A.BIN_InventoryInfoID = E.BIN_DepotInfoID)
			LEFT JOIN Basis.BIN_LogicInventory F
			ON(A.BIN_LogicInventoryInfoID = F.BIN_LogicInventoryInfoID)
			LEFT JOIN Basis.BIN_ProductBatch G
			ON(A.BIN_ProductBatchID = G.BIN_ProductBatchID)
		WHERE
			A.BIN_ProductInDepotID = #BIN_ProductInDepotID#
		]]>
	</select>

	<!-- 判断入库单据号存在 -->
	<select id="selProductInDepot" parameterClass="java.util.HashMap" resultClass ="java.util.HashMap">
        <![CDATA[
	        SELECT
	            A.BIN_ProductInDepotID,
	            A.WorkFlowID,
	            A.BIN_EmployeeID,
	            A.BIN_EmployeeIDAudit,
	            A.Comments
	        FROM
	            Inventory.BIN_ProductInDepot A
	        WHERE
	            A.BillNoIF = #relevantNo# AND
	            A.ValidFlag = '1'
        ]]>
    </select>

	<!--删除【产品入库单据明细表】-->
	<delete id="delProductInDepotDetailData" parameterClass="java.util.HashMap">
        <![CDATA[
            DELETE FROM
                Inventory.BIN_ProductInDepotDetail
            WHERE
                BIN_ProductInDepotID = #BIN_ProductInDepotID#
        ]]>
    </delete>

	<select id="selectInventoryIdByCounterCode" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		<![CDATA[

			SELECT
				II.BIN_InventoryInfoID
			FROM
				Basis.BIN_InventoryInfo II
			LEFT JOIN
				Basis.BIN_CounterInfo CI
			ON
				II.BIN_OrganizationID = CI.BIN_OrganizationID
			AND
				II.ValidFlag = '1' AND CI.ValidFlag = '1'
			WHERE
				CI.CounterCode = #departCode#
		]]>
	</select>

	<select id="selectProductVendorIdByBarCode" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		<![CDATA[

			SELECT
				PV.BIN_ProductVendorID
			FROM
				basis.BIN_ProductVendor PV
  			WHERE
  				PV.ValidFlag = 1
				AND PV.barCode = #barcode#
		]]>
	</select>

	<select id="selectProductIdByUnitCode" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		<![CDATA[

			SELECT
				PRO.BIN_ProductID
			FROM
				Basis.BIN_Product PRO
			WHERE
				PRO.ValidFlag = 1
				AND PRO.UnitCode = #unitcode#
		]]>
	</select>

</sqlMap>