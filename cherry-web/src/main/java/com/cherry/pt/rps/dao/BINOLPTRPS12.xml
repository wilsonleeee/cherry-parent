<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="BINOLPTRPS12">
	<!-- 取得产品历史库存数量SQL -->
	<sql id="ProStockhistorySQL">
		<![CDATA[
		SELECT
			H.BIN_InventoryInfoID,
			H.BIN_LogicInventoryInfoID,
			ISNULL(H.Quantity,0) AS hQuantity,
			0 AS hDinQuantity,
			0 AS hDoutQuantity,
			0 AS hinQuantity,		
			0 AS houtQuantity,		
			0 AS inQuantity1,
			0 AS inQuantity2,		
			0 AS inQuantity3,		
			0 AS inQuantity4,		
			0 AS inQuantity5,		
			0 AS inQuantity6,
			0 AS inQuantity7,
			0 AS inQuantity8,		
			0 AS outQuantity1,		
			0 AS outQuantity2,		
			0 AS outQuantity3,		
			0 AS outQuantity4,		
			0 AS outQuantity5,		
			0 AS outQuantity6,
			0 AS outQuantity7,
			0 AS outQuantity8,
			0 AS outQuantity9,
			0 AS outQuantity10,
			0 AS outQuantity11
		FROM
			Inventory.BIN_ProStockHistory H
		]]>
		<isNotEmpty property="productId">	
			JOIN Basis.BIN_ProductVendor T WITH(NOLOCK)
			ON(H.BIN_ProductVendorID = T.BIN_ProductVendorID
				AND T.BIN_ProductID = #productId#
				AND T.ValidFlag = #validFlag#)
		</isNotEmpty>
		<![CDATA[	
		WHERE
			H.CutOfDate = CONVERT(date,#cutOfDate#)
		]]>
		<isNotEmpty prepend="AND" property="prtVendorId">	
			H.BIN_ProductVendorID = #prtVendorId#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="depotId">	
			H.BIN_InventoryInfoID = #depotId#
		</isNotEmpty>
		<isNotEmpty property="lgcInventoryId" prepend="AND">
			H.BIN_LogicInventoryInfoID = #lgcInventoryId#
		</isNotEmpty>
		<![CDATA[AND H.ValidFlag = '1']]>
	</sql>
	<!-- 月度库存历史到集结日点延迟上传数据（入库）  -->
	<sql id="ProStockhDinSQL">
		<![CDATA[
		SELECT
			A1.BIN_InventoryInfoID,
			A1.BIN_LogicInventoryInfoID,
			0 AS hQuantity,
			ISNULL(A1.Quantity,0) AS hDinQuantity,
			0 AS hDoutQuantity,	
			0 AS hinQuantity,		
			0 AS houtQuantity,		
			0 AS inQuantity1,		
			0 AS inQuantity2,		
			0 AS inQuantity3,		
			0 AS inQuantity4,		
			0 AS inQuantity5,
			0 AS inQuantity6,
			0 AS inQuantity7,
			0 AS inQuantity8,		
			0 AS outQuantity1,		
			0 AS outQuantity2,		
			0 AS outQuantity3,		
			0 AS outQuantity4,		
			0 AS outQuantity5,		
			0 AS outQuantity6,
			0 AS outQuantity7,
			0 AS outQuantity8,
			0 AS outQuantity9,
			0 AS outQuantity10,
			0 AS outQuantity11		
		FROM
			Inventory.BIN_ProductInOut H WITH(NOLOCK)
			JOIN Inventory.BIN_ProductInOutDetail A1 WITH(NOLOCK)	
			ON(H.BIN_ProductInOutID = A1.BIN_ProductInOutID
				AND A1.StockType = '0'
				AND A1.ValidFlag = '1')
		]]>
		<isNotEmpty property="productId">	
			JOIN Basis.BIN_ProductVendor T WITH(NOLOCK)
			ON(A1.BIN_ProductVendorID = T.BIN_ProductVendorID
				AND T.BIN_ProductID = #productId#
				AND T.ValidFlag = #validFlag#)
		</isNotEmpty>
		<![CDATA[	
		WHERE
			H.StockInOutDate <= CONVERT(date,#cutOfDate#)
		]]>
		<isNotEmpty prepend="AND" property="prtVendorId">	
			A1.BIN_ProductVendorID = #prtVendorId#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="depotId">	
			A1.BIN_InventoryInfoID = #depotId#
		</isNotEmpty>
		<isNotEmpty property="lgcInventoryId" prepend="AND">
			A1.BIN_LogicInventoryInfoID = #lgcInventoryId#
		</isNotEmpty>
		<![CDATA[
			AND H.ValidFlag = '1'
			AND H.CloseFlag = '0'
		]]>
	</sql>
	<!-- 月度库存历史到集结日点延迟上传数据（出库）  -->
	<sql id="ProStockhDoutSQL">
		<![CDATA[
		SELECT
			A1.BIN_InventoryInfoID,
			A1.BIN_LogicInventoryInfoID,
			0 AS hQuantity,
			0 AS hDinQuantity,
			ISNULL(A1.Quantity,0) AS hDoutQuantity,	
			0 AS hinQuantity,		
			0 AS houtQuantity,		
			0 AS inQuantity1,		
			0 AS inQuantity2,		
			0 AS inQuantity3,		
			0 AS inQuantity4,		
			0 AS inQuantity5,
			0 AS inQuantity6,
			0 AS inQuantity7,
			0 AS inQuantity8,	
			0 AS outQuantity1,		
			0 AS outQuantity2,		
			0 AS outQuantity3,		
			0 AS outQuantity4,		
			0 AS outQuantity5,		
			0 AS outQuantity6,
			0 AS outQuantity7,
			0 AS outQuantity8,
			0 AS outQuantity9,
			0 AS outQuantity10,
			0 AS outQuantity11		
		FROM
			Inventory.BIN_ProductInOut H WITH(NOLOCK)		
			JOIN Inventory.BIN_ProductInOutDetail A1 WITH(NOLOCK)	
			ON(H.BIN_ProductInOutID = A1.BIN_ProductInOutID
				AND A1.StockType = '1'
				AND A1.ValidFlag = '1')
		]]>
		<isNotEmpty property="productId">	
			JOIN Basis.BIN_ProductVendor T WITH(NOLOCK)
			ON(A1.BIN_ProductVendorID = T.BIN_ProductVendorID
				AND T.BIN_ProductID = #productId#
				AND T.ValidFlag = #validFlag#)
		</isNotEmpty>
		<![CDATA[
		WHERE
			H.StockInOutDate <= CONVERT(date,#cutOfDate#)
			AND H.ValidFlag = '1'
			AND H.CloseFlag = '0'
		]]>
		<isNotEmpty prepend="AND" property="prtVendorId">	
			A1.BIN_ProductVendorID = #prtVendorId#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="depotId">	
			A1.BIN_InventoryInfoID = #depotId#
		</isNotEmpty>
		<isNotEmpty property="lgcInventoryId" prepend="AND">
			A1.BIN_LogicInventoryInfoID = #lgcInventoryId#
		</isNotEmpty>
	</sql>
	<!-- 取得产品历史库存到集结点的收入变化SQL -->
	<sql id="ProStockhinSQL">
		<![CDATA[
		SELECT
			A1.BIN_InventoryInfoID,
			A1.BIN_LogicInventoryInfoID,
			0 AS hQuantity,
			0 AS hDinQuantity,
			0 AS hDoutQuantity,	
			ISNULL(A1.Quantity,0) AS hinQuantity,		
			0 AS houtQuantity,		
			0 AS inQuantity1,		
			0 AS inQuantity2,		
			0 AS inQuantity3,		
			0 AS inQuantity4,		
			0 AS inQuantity5,
			0 AS inQuantity6,
			0 AS inQuantity7,
			0 AS inQuantity8,	
			0 AS outQuantity1,		
			0 AS outQuantity2,		
			0 AS outQuantity3,		
			0 AS outQuantity4,		
			0 AS outQuantity5,		
			0 AS outQuantity6,
			0 AS outQuantity7,
			0 AS outQuantity8,
			0 AS outQuantity9,
			0 AS outQuantity10,
			0 AS outQuantity11		
		FROM
			Inventory.BIN_ProductInOut H WITH(NOLOCK)		
			JOIN Inventory.BIN_ProductInOutDetail A1 WITH(NOLOCK)	
			ON(H.BIN_ProductInOutID = A1.BIN_ProductInOutID
				AND A1.StockType = '0'
				AND A1.ValidFlag = '1')
		]]>
		<isNotEmpty property="productId">	
			JOIN Basis.BIN_ProductVendor T WITH(NOLOCK)
			ON(A1.BIN_ProductVendorID = T.BIN_ProductVendorID
				AND T.BIN_ProductID = #productId#
				AND T.ValidFlag = #validFlag#)
		</isNotEmpty>
		<![CDATA[
		WHERE
			H.StockInOutDate > CONVERT(date,#date1#)	
			AND H.StockInOutDate <= CONVERT(date,#date2#)
			AND H.ValidFlag = '1'
		]]>
		<isNotEmpty prepend="AND" property="prtVendorId">	
			A1.BIN_ProductVendorID = #prtVendorId#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="depotId">	
			A1.BIN_InventoryInfoID = #depotId#
		</isNotEmpty>
		<isNotEmpty property="lgcInventoryId" prepend="AND">
			A1.BIN_LogicInventoryInfoID = #lgcInventoryId#
		</isNotEmpty>
	</sql>
	<!-- 取得产品历史库存到集结点的发出变化SQL -->
	<sql id="ProStockhoutSQL">
	 	<![CDATA[
		SELECT			
			A1.BIN_InventoryInfoID,
			A1.BIN_LogicInventoryInfoID,
			0 AS hQuantity,
			0 AS hDinQuantity,
			0 AS hDoutQuantity,	
			0 AS hinQuantity,		
			ISNULL(A1.Quantity,0) AS houtQuantity,		
			0 AS inQuantity1,		
			0 AS inQuantity2,		
			0 AS inQuantity3,		
			0 AS inQuantity4,		
			0 AS inQuantity5,		
			0 AS inQuantity6,
			0 AS inQuantity7,
			0 AS inQuantity8,	
			0 AS outQuantity1,		
			0 AS outQuantity2,		
			0 AS outQuantity3,		
			0 AS outQuantity4,		
			0 AS outQuantity5,		
			0 AS outQuantity6,
			0 AS outQuantity7,
			0 AS outQuantity8,
			0 AS outQuantity9,
			0 AS outQuantity10,
			0 AS outQuantity11
		FROM			
			Inventory.BIN_ProductInOut H WITH(NOLOCK)		
			JOIN Inventory.BIN_ProductInOutDetail A1 WITH(NOLOCK)	
			ON(H.BIN_ProductInOutID = A1.BIN_ProductInOutID
				AND A1.StockType = '1'
				AND A1.ValidFlag = '1')
		]]>
		<isNotEmpty property="productId">	
			JOIN Basis.BIN_ProductVendor T WITH(NOLOCK)
			ON(A1.BIN_ProductVendorID = T.BIN_ProductVendorID
				AND T.BIN_ProductID = #productId#
				AND T.ValidFlag = #validFlag#)
		</isNotEmpty>
		<![CDATA[
		WHERE
			H.StockInOutDate > CONVERT(date,#date1#)	
			AND H.StockInOutDate <= CONVERT(date,#date2#)
			AND H.ValidFlag = '1'		
	 	]]>
	 	<isNotEmpty prepend="AND" property="prtVendorId">	
			A1.BIN_ProductVendorID = #prtVendorId#
		</isNotEmpty>
	 	<isNotEmpty prepend="AND" property="depotId">	
			A1.BIN_InventoryInfoID = #depotId#
		</isNotEmpty>
		<isNotEmpty property="lgcInventoryId" prepend="AND">
			A1.BIN_LogicInventoryInfoID = #lgcInventoryId#
		</isNotEmpty>
	</sql>
	<!-- 取得产品本期仓库发货变化SQL -->
	<sql id="ProStockout1SQL">
		<![CDATA[
		SELECT			
			A1.BIN_InventoryInfoID,
			A1.BIN_LogicInventoryInfoID,
			0 AS hQuantity,
			0 AS hDinQuantity,
			0 AS hDoutQuantity,		
			0 AS hinQuantity,		
			0 AS houtQuantity,		
			0 AS inQuantity1,		
			0 AS inQuantity2,		
			0 AS inQuantity3,		
			0 AS inQuantity4,		
			0 AS inQuantity5,		
			0 AS inQuantity6,
			0 AS inQuantity7,
			0 AS inQuantity8,		
			CASE WHEN A1.StockType = '0' THEN (-1)*ISNULL(A1.Quantity,0) ELSE ISNULL(A1.Quantity,0) END AS outQuantity1,		
			0 AS outQuantity2,		
			0 AS outQuantity3,		
			0 AS outQuantity4,		
			0 AS outQuantity5,		
			0 AS outQuantity6,
			0 AS outQuantity7,
			0 AS outQuantity8,
			0 AS outQuantity9,
			0 AS outQuantity10,
			0 AS outQuantity11	
		FROM
			Inventory.BIN_ProductInOut H WITH(NOLOCK)		
			JOIN Inventory.BIN_ProductInOutDetail A1 WITH(NOLOCK)	
			ON(H.BIN_ProductInOutID = A1.BIN_ProductInOutID
				AND A1.ValidFlag = '1')
		]]>
		<isNotEmpty property="productId">	
			JOIN Basis.BIN_ProductVendor T WITH(NOLOCK)
			ON(A1.BIN_ProductVendorID = T.BIN_ProductVendorID
				AND T.BIN_ProductID = #productId#
				AND T.ValidFlag = #validFlag#)
		</isNotEmpty>
		<![CDATA[
		WHERE
			H.StockInOutDate >= CONVERT(date,#startDate#)	
			AND H.StockInOutDate <= CONVERT(date,#endDate#)
			AND H.TradeType = 'SD'
			AND H.ValidFlag = '1'		
		]]>
		<isNotEmpty prepend="AND" property="prtVendorId">	
			A1.BIN_ProductVendorID = #prtVendorId#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="depotId">	
			A1.BIN_InventoryInfoID = #depotId#
		</isNotEmpty>
		<isNotEmpty property="lgcInventoryId" prepend="AND">
			A1.BIN_LogicInventoryInfoID = #lgcInventoryId#
		</isNotEmpty>
	</sql>
	<!-- 取得产品本期仓库退库变化SQL -->
	<sql id="ProStockout2SQL">
		<![CDATA[
		SELECT			
			A1.BIN_InventoryInfoID,
			A1.BIN_LogicInventoryInfoID,
			0 AS hQuantity,
			0 AS hDinQuantity,
			0 AS hDoutQuantity,		
			0 AS hinQuantity,		
			0 AS houtQuantity,		
			0 AS inQuantity1,		
			0 AS inQuantity2,		
			0 AS inQuantity3,		
			0 AS inQuantity4,		
			0 AS inQuantity5,		
			0 AS inQuantity6,
			0 AS inQuantity7,
			0 AS inQuantity8,	
			0 AS outQuantity1,		
			CASE WHEN A1.StockType = '0' THEN (-1)*ISNULL(A1.Quantity,0) ELSE ISNULL(A1.Quantity,0) END AS outQuantity2,		
			0 AS outQuantity3,		
			0 AS outQuantity4,		
			0 AS outQuantity5,		
			0 AS outQuantity6,
			0 AS outQuantity7,
			0 AS outQuantity8,
			0 AS outQuantity9,
			0 AS outQuantity10,
			0 AS outQuantity11
		FROM
			Inventory.BIN_ProductInOut H WITH(NOLOCK)		
			JOIN Inventory.BIN_ProductInOutDetail A1 WITH(NOLOCK)	
			ON(H.BIN_ProductInOutID = A1.BIN_ProductInOutID
				AND A1.ValidFlag = '1')
		]]>
		<isNotEmpty property="productId">	
			JOIN Basis.BIN_ProductVendor T WITH(NOLOCK)
			ON(A1.BIN_ProductVendorID = T.BIN_ProductVendorID
				AND T.BIN_ProductID = #productId#
				AND T.ValidFlag = #validFlag#)
		</isNotEmpty>
		<![CDATA[
		WHERE			
			H.StockInOutDate >= CONVERT(date,#startDate#)	
			AND H.StockInOutDate <= CONVERT(date,#endDate#)
			AND H.TradeType = 'RR'
			AND H.ValidFlag = '1'		
		]]>
		<isNotEmpty prepend="AND" property="prtVendorId">	
			A1.BIN_ProductVendorID = #prtVendorId#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="depotId">	
			A1.BIN_InventoryInfoID = #depotId#
		</isNotEmpty>
		<isNotEmpty property="lgcInventoryId" prepend="AND">
			A1.BIN_LogicInventoryInfoID = #lgcInventoryId#
		</isNotEmpty>
	</sql>
	<!-- 取得产品本期调出变化SQL -->
	<sql id="ProStockout3SQL">
		<![CDATA[
		SELECT			
			A1.BIN_InventoryInfoID,
			A1.BIN_LogicInventoryInfoID,
			0 AS hQuantity,
			0 AS hDinQuantity,
			0 AS hDoutQuantity,
			0 AS hinQuantity,		
			0 AS houtQuantity,		
			0 AS inQuantity1,		
			0 AS inQuantity2,		
			0 AS inQuantity3,		
			0 AS inQuantity4,		
			0 AS inQuantity5,		
			0 AS inQuantity6,
			0 AS inQuantity7,
			0 AS inQuantity8,		
			0 AS outQuantity1,		
			0 AS outQuantity2,		
			CASE WHEN A1.StockType = '0' THEN (-1)*ISNULL(A1.Quantity,0) ELSE ISNULL(A1.Quantity,0) END AS outQuantity3,		
			0 AS outQuantity4,		
			0 AS outQuantity5,		
			0 AS outQuantity6,
			0 AS outQuantity7,
			0 AS outQuantity8,
			0 AS outQuantity9,
			0 AS outQuantity10,
			0 AS outQuantity11		
		FROM			
			Inventory.BIN_ProductInOut H WITH(NOLOCK)		
			JOIN Inventory.BIN_ProductInOutDetail A1 WITH(NOLOCK)	
			ON(H.BIN_ProductInOutID = A1.BIN_ProductInOutID
				AND A1.ValidFlag = '1')
		]]>
		<isNotEmpty property="productId">	
			JOIN Basis.BIN_ProductVendor T WITH(NOLOCK)
			ON(A1.BIN_ProductVendorID = T.BIN_ProductVendorID
				AND T.BIN_ProductID = #productId#
				AND T.ValidFlag = #validFlag#)
		</isNotEmpty>
		<![CDATA[
		WHERE			
			H.StockInOutDate >= CONVERT(date,#startDate#)	
			AND H.StockInOutDate <= CONVERT(date,#endDate#)	
			AND H.TradeType = 'LG'
			AND H.ValidFlag = '1'		
		]]>
		<isNotEmpty prepend="AND" property="prtVendorId">	
			A1.BIN_ProductVendorID = #prtVendorId#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="depotId">	
			A1.BIN_InventoryInfoID = #depotId#
		</isNotEmpty>
		<isNotEmpty property="lgcInventoryId" prepend="AND">
			A1.BIN_LogicInventoryInfoID = #lgcInventoryId#
		</isNotEmpty>
	</sql>
	<!-- 取得产品本期自由出库变化SQL -->
	<sql id="ProStockout4SQL">
		<![CDATA[
		SELECT			
			A1.BIN_InventoryInfoID,
			A1.BIN_LogicInventoryInfoID,
			0 AS hQuantity,
			0 AS hDinQuantity,
			0 AS hDoutQuantity,		
			0 AS hinQuantity,		
			0 AS houtQuantity,		
			0 AS inQuantity1,		
			0 AS inQuantity2,		
			0 AS inQuantity3,		
			0 AS inQuantity4,		
			0 AS inQuantity5,		
			0 AS inQuantity6,
			0 AS inQuantity7,
			0 AS inQuantity8,	
			0 AS outQuantity1,		
			0 AS outQuantity2,		
			0 AS outQuantity3,		
			CASE WHEN A1.StockType = '0' THEN (-1)*ISNULL(A1.Quantity,0) ELSE ISNULL(A1.Quantity,0) END AS outQuantity4,		
			0 AS outQuantity5,		
			0 AS outQuantity6,
			0 AS outQuantity7,
			0 AS outQuantity8,
			0 AS outQuantity9,
			0 AS outQuantity10,
			0 AS outQuantity11		
		FROM
			Inventory.BIN_ProductInOut H WITH(NOLOCK)		
			JOIN Inventory.BIN_ProductInOutDetail A1 WITH(NOLOCK)	
			ON(H.BIN_ProductInOutID = A1.BIN_ProductInOutID
				AND A1.ValidFlag = '1')
		]]>
		<isNotEmpty property="productId">	
			JOIN Basis.BIN_ProductVendor T WITH(NOLOCK)
			ON(A1.BIN_ProductVendorID = T.BIN_ProductVendorID
				AND T.BIN_ProductID = #productId#
				AND T.ValidFlag = #validFlag#)
		</isNotEmpty>
		<![CDATA[
		WHERE			
			H.StockInOutDate >= CONVERT(date,#startDate#)	
			AND H.StockInOutDate <= CONVERT(date,#endDate#)	
			AND H.TradeType = 'OT'
			AND H.ValidFlag = '1'		
		]]>
		<isNotEmpty prepend="AND" property="prtVendorId">	
			A1.BIN_ProductVendorID = #prtVendorId#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="depotId">	
			A1.BIN_InventoryInfoID = #depotId#
		</isNotEmpty>
		<isNotEmpty property="lgcInventoryId" prepend="AND">
			A1.BIN_LogicInventoryInfoID = #lgcInventoryId#
		</isNotEmpty>
	</sql>
	<!-- 取得产品本期盘亏变化SQL -->
	<sql id="ProStockout5SQL">
		<![CDATA[
		SELECT			
			A1.BIN_InventoryInfoID,
			A1.BIN_LogicInventoryInfoID,
			0 AS hQuantity,
			0 AS hDinQuantity,
			0 AS hDoutQuantity,		
			0 AS hinQuantity,		
			0 AS houtQuantity,		
			0 AS inQuantity1,		
			0 AS inQuantity2,		
			0 AS inQuantity3,		
			0 AS inQuantity4,		
			0 AS inQuantity5,		
			0 AS inQuantity6,
			0 AS inQuantity7,
			0 AS inQuantity8,	
			0 AS outQuantity1,		
			0 AS outQuantity2,		
			0 AS outQuantity3,		
			0 AS outQuantity4,		
			ISNULL(A1.Quantity,0) AS outQuantity5,		
			0 AS outQuantity6,
			0 AS outQuantity7,
			0 AS outQuantity8,
			0 AS outQuantity9,
			0 AS outQuantity10,
			0 AS outQuantity11
		FROM			
			Inventory.BIN_ProductInOut H WITH(NOLOCK)		
			JOIN Inventory.BIN_ProductInOutDetail A1 WITH(NOLOCK)	
			ON(H.BIN_ProductInOutID = A1.BIN_ProductInOutID
				AND A1.StockType = '1'
				AND A1.ValidFlag = '1')
		]]>
		<isNotEmpty property="productId">	
			JOIN Basis.BIN_ProductVendor T WITH(NOLOCK)
			ON(A1.BIN_ProductVendorID = T.BIN_ProductVendorID
				AND T.BIN_ProductID = #productId#
				AND T.ValidFlag = #validFlag#)
		</isNotEmpty>
		<![CDATA[
		WHERE			
			H.StockInOutDate >= CONVERT(date,#startDate#)	
			AND H.StockInOutDate <= CONVERT(date,#endDate#)	
			AND H.TradeType = 'CA'
			AND H.ValidFlag = '1'		
		]]>
		<isNotEmpty prepend="AND" property="prtVendorId">	
			A1.BIN_ProductVendorID = #prtVendorId#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="depotId">	
			A1.BIN_InventoryInfoID = #depotId#
		</isNotEmpty>
		<isNotEmpty property="lgcInventoryId" prepend="AND">
			A1.BIN_LogicInventoryInfoID = #lgcInventoryId#
		</isNotEmpty>
	</sql>
	<!-- 取得产品本期销售出库变化SQL -->
	<sql id="ProStockout6SQL">
		<![CDATA[
		SELECT			
			A1.BIN_InventoryInfoID,
			A1.BIN_LogicInventoryInfoID,
			0 AS hQuantity,
			0 AS hDinQuantity,
			0 AS hDoutQuantity,	
			0 AS hinQuantity,		
			0 AS houtQuantity,		
			0 AS inQuantity1,		
			0 AS inQuantity2,		
			0 AS inQuantity3,		
			0 AS inQuantity4,		
			0 AS inQuantity5,		
			0 AS inQuantity6,
			0 AS inQuantity7,
			0 AS inQuantity8,		
			0 AS outQuantity1,		
			0 AS outQuantity2,		
			0 AS outQuantity3,		
			0 AS outQuantity4,		
			0 AS outQuantity5,		
			ISNULL(A1.Quantity,0) AS outQuantity6,
			0 AS outQuantity7,
			0 AS outQuantity8,
			0 AS outQuantity9,
			0 AS outQuantity10,
			0 AS outQuantity11
		FROM			
			Inventory.BIN_ProductInOut H WITH(NOLOCK)		
			JOIN Inventory.BIN_ProductInOutDetail A1 WITH(NOLOCK)	
			ON(H.BIN_ProductInOutID = A1.BIN_ProductInOutID
				AND A1.StockType = '1'
				AND A1.ValidFlag = '1')	
		]]>
		<isNotEmpty property="productId">	
			JOIN Basis.BIN_ProductVendor T WITH(NOLOCK)
			ON(A1.BIN_ProductVendorID = T.BIN_ProductVendorID
				AND T.BIN_ProductID = #productId#
				AND T.ValidFlag = #validFlag#)
		</isNotEmpty>
		<![CDATA[
		WHERE			
			H.StockInOutDate >= CONVERT(date,#startDate#)	
			AND H.StockInOutDate <= CONVERT(date,#endDate#)
			AND (H.TradeType = 'NS' OR H.TradeType = 'SR')
			AND H.ValidFlag = '1'		
		]]>
		<isNotEmpty prepend="AND" property="prtVendorId">	
			A1.BIN_ProductVendorID = #prtVendorId#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="depotId">	
			A1.BIN_InventoryInfoID = #depotId#
		</isNotEmpty>
		<isNotEmpty property="lgcInventoryId" prepend="AND">
			A1.BIN_LogicInventoryInfoID = #lgcInventoryId#
		</isNotEmpty>
	</sql>
	<!-- 取得产品本期移出变化SQL -->
	<sql id="ProStockout7SQL">
		<![CDATA[
		SELECT			
			A1.BIN_InventoryInfoID,
			A1.BIN_LogicInventoryInfoID,
			0 AS hQuantity,
			0 AS hDinQuantity,
			0 AS hDoutQuantity,		
			0 AS hinQuantity,		
			0 AS houtQuantity,		
			0 AS inQuantity1,		
			0 AS inQuantity2,		
			0 AS inQuantity3,		
			0 AS inQuantity4,		
			0 AS inQuantity5,		
			0 AS inQuantity6,
			0 AS inQuantity7,
			0 AS inQuantity8,		
			0 AS outQuantity1,		
			0 AS outQuantity2,		
			0 AS outQuantity3,		
			0 AS outQuantity4,		
			0 AS outQuantity5,		
			0 AS outQuantity6,
			ISNULL(A1.Quantity,0) AS outQuantity7,
			0 AS outQuantity8,
			0 AS outQuantity9,
			0 AS outQuantity10,
			0 AS outQuantity11
		FROM			
			Inventory.BIN_ProductInOut H WITH(NOLOCK)		
			JOIN Inventory.BIN_ProductInOutDetail A1 WITH(NOLOCK)	
			ON(H.BIN_ProductInOutID = A1.BIN_ProductInOutID
				AND A1.StockType = '1'
				AND A1.ValidFlag = '1')
		]]>
		<isNotEmpty property="productId">	
			JOIN Basis.BIN_ProductVendor T WITH(NOLOCK)
			ON(A1.BIN_ProductVendorID = T.BIN_ProductVendorID
				AND T.BIN_ProductID = #productId#
				AND T.ValidFlag = #validFlag#)
		</isNotEmpty>
		<![CDATA[
		WHERE			
			H.StockInOutDate >= CONVERT(date,#startDate#)	
			AND H.StockInOutDate <= CONVERT(date,#endDate#)	
			AND H.TradeType = 'MV'
			AND H.ValidFlag = '1'		
		]]>
		<isNotEmpty prepend="AND" property="prtVendorId">	
			A1.BIN_ProductVendorID = #prtVendorId#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="depotId">	
			A1.BIN_InventoryInfoID = #depotId#
		</isNotEmpty>
		<isNotEmpty property="lgcInventoryId" prepend="AND">
			A1.BIN_LogicInventoryInfoID = #lgcInventoryId#
		</isNotEmpty>
	</sql>
	<!-- 取得产品本期报损变化SQL -->
	<sql id="ProStockout8SQL">
		<![CDATA[
		SELECT			
			A1.BIN_InventoryInfoID,
			A1.BIN_LogicInventoryInfoID,
			0 AS hQuantity,
			0 AS hDinQuantity,
			0 AS hDoutQuantity,		
			0 AS hinQuantity,		
			0 AS houtQuantity,		
			0 AS inQuantity1,		
			0 AS inQuantity2,		
			0 AS inQuantity3,		
			0 AS inQuantity4,		
			0 AS inQuantity5,		
			0 AS inQuantity6,
			0 AS inQuantity7,
			0 AS inQuantity8,
			0 AS outQuantity1,		
			0 AS outQuantity2,		
			0 AS outQuantity3,		
			0 AS outQuantity4,		
			0 AS outQuantity5,		
			0 AS outQuantity6,
			0 AS outQuantity7,
			CASE WHEN A1.StockType = '0' THEN (-1)*ISNULL(A1.Quantity,0) ELSE ISNULL(A1.Quantity,0) END AS outQuantity8,
			0 AS outQuantity9,
			0 AS outQuantity10,
			0 AS outQuantity11		
		FROM			
			Inventory.BIN_ProductInOut H WITH(NOLOCK)		
			JOIN Inventory.BIN_ProductInOutDetail A1 WITH(NOLOCK)	
			ON(H.BIN_ProductInOutID = A1.BIN_ProductInOutID
				AND A1.ValidFlag = '1')
		]]>
		<isNotEmpty property="productId">	
			JOIN Basis.BIN_ProductVendor T WITH(NOLOCK)
			ON(A1.BIN_ProductVendorID = T.BIN_ProductVendorID
				AND T.BIN_ProductID = #productId#
				AND T.ValidFlag = #validFlag#)
		</isNotEmpty>
		<![CDATA[
		WHERE			
			H.StockInOutDate >= CONVERT(date,#startDate#)	
			AND H.StockInOutDate <= CONVERT(date,#endDate#)	
			AND H.TradeType = 'LS'
			AND H.ValidFlag = '1'		
		]]>
		<isNotEmpty prepend="AND" property="prtVendorId">	
			A1.BIN_ProductVendorID = #prtVendorId#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="depotId">	
			A1.BIN_InventoryInfoID = #depotId#
		</isNotEmpty>
		<isNotEmpty property="lgcInventoryId" prepend="AND">
			A1.BIN_LogicInventoryInfoID = #lgcInventoryId#
		</isNotEmpty>
	</sql>
	<!-- 取得产品本期礼品领用变化SQL -->
	<sql id="ProStockout9SQL">
		<![CDATA[
		SELECT			
			A1.BIN_InventoryInfoID,
			A1.BIN_LogicInventoryInfoID,
			0 AS hQuantity,
			0 AS hDinQuantity,
			0 AS hDoutQuantity,		
			0 AS hinQuantity,		
			0 AS houtQuantity,		
			0 AS inQuantity1,		
			0 AS inQuantity2,		
			0 AS inQuantity3,		
			0 AS inQuantity4,		
			0 AS inQuantity5,		
			0 AS inQuantity6,
			0 AS inQuantity7,
			0 AS inQuantity8,		
			0 AS outQuantity1,		
			0 AS outQuantity2,		
			0 AS outQuantity3,		
			0 AS outQuantity4,		
			0 AS outQuantity5,		
			0 AS outQuantity6,
			0 AS outQuantity7,
			0 AS outQuantity8,
			CASE WHEN A1.StockType = '0' THEN (-1)*ISNULL(A1.Quantity,0) ELSE ISNULL(A1.Quantity,0) END AS outQuantity9,
			0 AS outQuantity10,
			0 AS outQuantity11	
		FROM			
			Inventory.BIN_ProductInOut H WITH(NOLOCK)		
			JOIN Inventory.BIN_ProductInOutDetail A1 WITH(NOLOCK)	
			ON(H.BIN_ProductInOutID = A1.BIN_ProductInOutID
				AND A1.ValidFlag = '1')
		]]>
		<isNotEmpty property="productId">	
			JOIN Basis.BIN_ProductVendor T WITH(NOLOCK)
			ON(A1.BIN_ProductVendorID = T.BIN_ProductVendorID
				AND T.BIN_ProductID = #productId#
				AND T.ValidFlag = #validFlag#)
		</isNotEmpty>
		<![CDATA[
		WHERE			
			H.StockInOutDate >= CONVERT(date,#startDate#)	
			AND H.StockInOutDate <= CONVERT(date,#endDate#)	
			AND H.TradeType = 'SP'
			AND H.ValidFlag = '1'
		]]>
		<isNotEmpty prepend="AND" property="prtVendorId">	
			A1.BIN_ProductVendorID = #prtVendorId#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="depotId">	
			A1.BIN_InventoryInfoID = #depotId#
		</isNotEmpty>
		<isNotEmpty property="lgcInventoryId" prepend="AND">
			A1.BIN_LogicInventoryInfoID = #lgcInventoryId#
		</isNotEmpty>
	</sql>
	<!-- 取得产品本期积分兑换变化SQL -->
	<sql id="ProStockout10SQL">
		<![CDATA[
		SELECT			
			A1.BIN_InventoryInfoID,
			A1.BIN_LogicInventoryInfoID,
			0 AS hQuantity,
			0 AS hDinQuantity,
			0 AS hDoutQuantity,		
			0 AS hinQuantity,		
			0 AS houtQuantity,		
			0 AS inQuantity1,		
			0 AS inQuantity2,		
			0 AS inQuantity3,		
			0 AS inQuantity4,		
			0 AS inQuantity5,		
			0 AS inQuantity6,
			0 AS inQuantity7,
			0 AS inQuantity8,	
			0 AS outQuantity1,		
			0 AS outQuantity2,		
			0 AS outQuantity3,		
			0 AS outQuantity4,		
			0 AS outQuantity5,		
			0 AS outQuantity6,
			0 AS outQuantity7,
			0 AS outQuantity8,
			0 AS outQuantity9,
			CASE WHEN A1.StockType = '0' THEN (-1)*ISNULL(A1.Quantity,0) ELSE ISNULL(A1.Quantity,0) END AS outQuantity10,
			0 AS outQuantity11
		FROM			
			Inventory.BIN_ProductInOut H WITH(NOLOCK)		
			JOIN Inventory.BIN_ProductInOutDetail A1 WITH(NOLOCK)	
			ON(H.BIN_ProductInOutID = A1.BIN_ProductInOutID
				AND A1.ValidFlag = '1')
		]]>
		<isNotEmpty property="productId">	
			JOIN Basis.BIN_ProductVendor T WITH(NOLOCK)
			ON(A1.BIN_ProductVendorID = T.BIN_ProductVendorID
				AND T.BIN_ProductID = #productId#
				AND T.ValidFlag = #validFlag#)
		</isNotEmpty>
		<![CDATA[
		WHERE			
			H.StockInOutDate >= CONVERT(date,#startDate#)	
			AND H.StockInOutDate <= CONVERT(date,#endDate#)	
			AND H.TradeType = 'PX'
			AND H.ValidFlag = '1'
		]]>
		<isNotEmpty prepend="AND" property="prtVendorId">	
			A1.BIN_ProductVendorID = #prtVendorId#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="depotId">	
			A1.BIN_InventoryInfoID = #depotId#
		</isNotEmpty>
		<isNotEmpty property="lgcInventoryId" prepend="AND">
			A1.BIN_LogicInventoryInfoID = #lgcInventoryId#
		</isNotEmpty>
	</sql>
		<!-- 取得产品本期销售出库变化SQL -->
	<sql id="ProStockout11SQL">
		<![CDATA[
		SELECT			
			A1.BIN_InventoryInfoID,
			A1.BIN_LogicInventoryInfoID,
			0 AS hQuantity,
			0 AS hDinQuantity,
			0 AS hDoutQuantity,	
			0 AS hinQuantity,		
			0 AS houtQuantity,		
			0 AS inQuantity1,		
			0 AS inQuantity2,		
			0 AS inQuantity3,		
			0 AS inQuantity4,		
			0 AS inQuantity5,		
			0 AS inQuantity6,
			0 AS inQuantity7,
			0 AS inQuantity8,		
			0 AS outQuantity1,		
			0 AS outQuantity2,		
			0 AS outQuantity3,		
			0 AS outQuantity4,		
			0 AS outQuantity5,		
			0 AS outQuantity6,	
			0 AS outQuantity7,
			0 AS outQuantity8,
			0 AS outQuantity9,
			0 AS outQuantity10,
			ISNULL(A1.Quantity,0) AS outQuantity11
		FROM			
			Inventory.BIN_ProductInOut H WITH(NOLOCK)		
			JOIN Inventory.BIN_ProductInOutDetail A1 WITH(NOLOCK)	
			ON(H.BIN_ProductInOutID = A1.BIN_ProductInOutID
				AND A1.StockType = '1'
				AND A1.ValidFlag = '1')	
		]]>
		<isNotEmpty property="productId">	
			JOIN Basis.BIN_ProductVendor T WITH(NOLOCK)
			ON(A1.BIN_ProductVendorID = T.BIN_ProductVendorID
				AND T.BIN_ProductID = #productId#
				AND T.ValidFlag = #validFlag#)
		</isNotEmpty>
		<![CDATA[
		WHERE			
			H.StockInOutDate >= CONVERT(date,#startDate#)	
			AND H.StockInOutDate <= CONVERT(date,#endDate#)
			AND (H.TradeType = 'DG' OR H.TradeType = 'RG')
			AND H.ValidFlag = '1'		
		]]>
		<isNotEmpty prepend="AND" property="prtVendorId">	
			A1.BIN_ProductVendorID = #prtVendorId#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="depotId">	
			A1.BIN_InventoryInfoID = #depotId#
		</isNotEmpty>
		<isNotEmpty property="lgcInventoryId" prepend="AND">
			A1.BIN_LogicInventoryInfoID = #lgcInventoryId#
		</isNotEmpty>
	</sql>
	<!-- 取得产品本期仓库收货变化SQL -->
	<sql id="ProStockin1SQL">
		<![CDATA[
		SELECT			
			A1.BIN_InventoryInfoID,
			A1.BIN_LogicInventoryInfoID,
			0 AS hQuantity,
			0 AS hDinQuantity,
			0 AS hDoutQuantity,	
			0 AS hinQuantity,		
			0 AS houtQuantity,		
			CASE WHEN A1.StockType = '1' THEN (-1)*ISNULL(A1.Quantity,0) ELSE ISNULL(A1.Quantity,0) END AS inQuantity1,		
			0 AS inQuantity2,		
			0 AS inQuantity3,		
			0 AS inQuantity4,		
			0 AS inQuantity5,		
			0 AS inQuantity6,
			0 AS inQuantity7,
			0 AS inQuantity8,	
			0 AS outQuantity1,		
			0 AS outQuantity2,		
			0 AS outQuantity3,		
			0 AS outQuantity4,		
			0 AS outQuantity5,		
			0 AS outQuantity6,
			0 AS outQuantity7,
			0 AS outQuantity8,
			0 AS outQuantity9,
			0 AS outQuantity10,
			0 AS outQuantity11
		FROM			
			Inventory.BIN_ProductInOut H WITH(NOLOCK)		
			JOIN Inventory.BIN_ProductInOutDetail A1 WITH(NOLOCK)	
			ON(H.BIN_ProductInOutID = A1.BIN_ProductInOutID
				AND A1.ValidFlag = '1')
		]]>
		<isNotEmpty property="productId">	
			JOIN Basis.BIN_ProductVendor T WITH(NOLOCK)
			ON(A1.BIN_ProductVendorID = T.BIN_ProductVendorID
				AND T.BIN_ProductID = #productId#
				AND T.ValidFlag = #validFlag#)
		</isNotEmpty>
		<![CDATA[
		WHERE			
			H.StockInOutDate >= CONVERT(date,#startDate#)	
			AND H.StockInOutDate <= CONVERT(date,#endDate#)	
			AND H.TradeType = 'RD'
			AND H.ValidFlag = '1'		
		]]>
		<isNotEmpty prepend="AND" property="prtVendorId">	
			A1.BIN_ProductVendorID = #prtVendorId#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="depotId">	
			A1.BIN_InventoryInfoID = #depotId#
		</isNotEmpty>
		<isNotEmpty property="lgcInventoryId" prepend="AND">
			A1.BIN_LogicInventoryInfoID = #lgcInventoryId#
		</isNotEmpty>
	</sql>
	<!-- 取得产品本期接受退库变化SQL -->
	<sql id="ProStockin2SQL">
		<![CDATA[
		SELECT			
			A1.BIN_InventoryInfoID,
			A1.BIN_LogicInventoryInfoID,
			0 AS hQuantity,
			0 AS hDinQuantity,
			0 AS hDoutQuantity,		
			0 AS hinQuantity,		
			0 AS houtQuantity,		
			0 AS inQuantity1,		
			CASE WHEN A1.StockType = '1' THEN (-1)*ISNULL(A1.Quantity,0) ELSE ISNULL(A1.Quantity,0) END AS inQuantity2,		
			0 AS inQuantity3,		
			0 AS inQuantity4,		
			0 AS inQuantity5,		
			0 AS inQuantity6,
			0 AS inQuantity7,
			0 AS inQuantity8,	
			0 AS outQuantity1,		
			0 AS outQuantity2,		
			0 AS outQuantity3,		
			0 AS outQuantity4,		
			0 AS outQuantity5,		
			0 AS outQuantity6,
			0 AS outQuantity7,
			0 AS outQuantity8,
			0 AS outQuantity9,
			0 AS outQuantity10,
			0 AS outQuantity11		
		FROM			
			Inventory.BIN_ProductInOut H WITH(NOLOCK)		
			JOIN Inventory.BIN_ProductInOutDetail A1 WITH(NOLOCK)	
			ON(H.BIN_ProductInOutID = A1.BIN_ProductInOutID
				AND A1.ValidFlag = '1')
		]]>
		<isNotEmpty property="productId">	
			JOIN Basis.BIN_ProductVendor T WITH(NOLOCK)
			ON(A1.BIN_ProductVendorID = T.BIN_ProductVendorID
				AND T.BIN_ProductID = #productId#
				AND T.ValidFlag = #validFlag#)
		</isNotEmpty>
		<![CDATA[
		WHERE			
			H.StockInOutDate >= CONVERT(date,#startDate#)	
			AND H.StockInOutDate <= CONVERT(date,#endDate#)	
			AND H.TradeType = 'AR'
			AND H.ValidFlag = '1'		
		]]>
		<isNotEmpty prepend="AND" property="prtVendorId">	
			A1.BIN_ProductVendorID = #prtVendorId#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="depotId">	
			A1.BIN_InventoryInfoID = #depotId#
		</isNotEmpty>
		<isNotEmpty property="lgcInventoryId" prepend="AND">
			A1.BIN_LogicInventoryInfoID = #lgcInventoryId#
		</isNotEmpty>
	</sql>
	<!-- 取得产品本期调入变化SQL -->
	<sql id="ProStockin3SQL">
		<![CDATA[
		SELECT			
			A1.BIN_InventoryInfoID,
			A1.BIN_LogicInventoryInfoID,
			0 AS hQuantity,
			0 AS hDinQuantity,
			0 AS hDoutQuantity,		
			0 AS hinQuantity,		
			0 AS houtQuantity,		
			0 AS inQuantity1,		
			0 AS inQuantity2,		
			CASE WHEN A1.StockType = '1' THEN (-1)*ISNULL(A1.Quantity,0) ELSE ISNULL(A1.Quantity,0) END AS inQuantity3,		
			0 AS inQuantity4,		
			0 AS inQuantity5,		
			0 AS inQuantity6,
			0 AS inQuantity7,
			0 AS inQuantity8,		
			0 AS outQuantity1,		
			0 AS outQuantity2,		
			0 AS outQuantity3,		
			0 AS outQuantity4,		
			0 AS outQuantity5,		
			0 AS outQuantity6,
			0 AS outQuantity7,
			0 AS outQuantity8,
			0 AS outQuantity9,
			0 AS outQuantity10,
			0 AS outQuantity11	
		FROM			
			Inventory.BIN_ProductInOut H WITH(NOLOCK)		
			JOIN Inventory.BIN_ProductInOutDetail A1 WITH(NOLOCK)	
			ON(H.BIN_ProductInOutID = A1.BIN_ProductInOutID
				AND A1.ValidFlag = '1')
		]]>
		<isNotEmpty property="productId">	
			JOIN Basis.BIN_ProductVendor T WITH(NOLOCK)
			ON(A1.BIN_ProductVendorID = T.BIN_ProductVendorID
				AND T.BIN_ProductID = #productId#
				AND T.ValidFlag = #validFlag#)
		</isNotEmpty>
		<![CDATA[
		WHERE			
			H.StockInOutDate >= CONVERT(date,#startDate#)	
			AND H.StockInOutDate <= CONVERT(date,#endDate#)	
			AND H.TradeType = 'BG'
			AND H.ValidFlag = '1'		
		]]>
		<isNotEmpty prepend="AND" property="prtVendorId">	
			A1.BIN_ProductVendorID = #prtVendorId#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="depotId">	
			A1.BIN_InventoryInfoID = #depotId#
		</isNotEmpty>
		<isNotEmpty property="lgcInventoryId" prepend="AND">
			A1.BIN_LogicInventoryInfoID = #lgcInventoryId#
		</isNotEmpty>
	</sql>
	<!-- 取得产品本期自由入库变化SQL -->
	<sql id="ProStockin4SQL">
		<![CDATA[
		SELECT			
			A1.BIN_InventoryInfoID,
			A1.BIN_LogicInventoryInfoID,
			0 AS hQuantity,
			0 AS hDinQuantity,
			0 AS hDoutQuantity,	
			0 AS hinQuantity,		
			0 AS houtQuantity,		
			0 AS inQuantity1,		
			0 AS inQuantity2,		
			0 AS inQuantity3,		
			CASE WHEN A1.StockType = '1' THEN (-1)*ISNULL(A1.Quantity,0) ELSE ISNULL(A1.Quantity,0) END AS inQuantity4,		
			0 AS inQuantity5,		
			0 AS inQuantity6,
			0 AS inQuantity7,
			0 AS inQuantity8,		
			0 AS outQuantity1,		
			0 AS outQuantity2,		
			0 AS outQuantity3,		
			0 AS outQuantity4,		
			0 AS outQuantity5,		
			0 AS outQuantity6,
			0 AS outQuantity7,
			0 AS outQuantity8,
			0 AS outQuantity9,
			0 AS outQuantity10,
			0 AS outQuantity11	
		FROM			
			Inventory.BIN_ProductInOut H WITH(NOLOCK)		
			JOIN Inventory.BIN_ProductInOutDetail A1 WITH(NOLOCK)	
			ON(H.BIN_ProductInOutID = A1.BIN_ProductInOutID
				AND A1.ValidFlag = '1')
		]]>
		<isNotEmpty property="productId">	
			JOIN Basis.BIN_ProductVendor T WITH(NOLOCK)
			ON(A1.BIN_ProductVendorID = T.BIN_ProductVendorID
				AND T.BIN_ProductID = #productId#
				AND T.ValidFlag = #validFlag#)
		</isNotEmpty>
		<![CDATA[
		WHERE
			H.StockInOutDate >= CONVERT(date,#startDate#)	
			AND H.StockInOutDate <= CONVERT(date,#endDate#)	
			AND H.TradeType = 'GR'
			AND H.ValidFlag = '1'	
		]]>
		<isNotEmpty prepend="AND" property="prtVendorId">	
			A1.BIN_ProductVendorID = #prtVendorId#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="depotId">	
			A1.BIN_InventoryInfoID = #depotId#
		</isNotEmpty>
		<isNotEmpty property="lgcInventoryId" prepend="AND">
			A1.BIN_LogicInventoryInfoID = #lgcInventoryId#
		</isNotEmpty>
	</sql>
	<!-- 取得产品本期盘盈变化SQL -->
	<sql id="ProStockin5SQL">
		<![CDATA[
		SELECT			
			A1.BIN_InventoryInfoID,
			A1.BIN_LogicInventoryInfoID,
			0 AS hQuantity,
			0 AS hDinQuantity,
			0 AS hDoutQuantity,		
			0 AS hinQuantity,		
			0 AS houtQuantity,		
			0 AS inQuantity1,		
			0 AS inQuantity2,		
			0 AS inQuantity3,		
			0 AS inQuantity4,		
			ISNULL(A1.Quantity,0) AS inQuantity5,		
			0 AS inQuantity6,
			0 AS inQuantity7,
			0 AS inQuantity8,		
			0 AS outQuantity1,		
			0 AS outQuantity2,		
			0 AS outQuantity3,		
			0 AS outQuantity4,		
			0 AS outQuantity5,		
			0 AS outQuantity6,
			0 AS outQuantity7,
			0 AS outQuantity8,
			0 AS outQuantity9,
			0 AS outQuantity10,
			0 AS outQuantity11	
		FROM			
			Inventory.BIN_ProductInOut H WITH(NOLOCK)		
			JOIN Inventory.BIN_ProductInOutDetail A1 WITH(NOLOCK)	
			ON(H.BIN_ProductInOutID = A1.BIN_ProductInOutID
				AND A1.StockType = '0'
				AND A1.ValidFlag = '1')
		]]>
		<isNotEmpty property="productId">	
			JOIN Basis.BIN_ProductVendor T WITH(NOLOCK)
			ON(A1.BIN_ProductVendorID = T.BIN_ProductVendorID
				AND T.BIN_ProductID = #productId#
				AND T.ValidFlag = #validFlag#)
		</isNotEmpty>
		<![CDATA[
		WHERE			
			H.StockInOutDate >= CONVERT(date,#startDate#)	
			AND H.StockInOutDate <= CONVERT(date,#endDate#)	
			AND H.TradeType = 'CA'
			AND H.ValidFlag = '1'		
		]]>
		<isNotEmpty prepend="AND" property="prtVendorId">	
			A1.BIN_ProductVendorID = #prtVendorId#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="depotId">	
			A1.BIN_InventoryInfoID = #depotId#
		</isNotEmpty>
		<isNotEmpty property="lgcInventoryId" prepend="AND">
			A1.BIN_LogicInventoryInfoID = #lgcInventoryId#
		</isNotEmpty>
	</sql>
	<!-- 取得产品本期销售入库变化SQL -->
	<sql id="ProStockin6SQL">
		<![CDATA[
		SELECT			
			A1.BIN_InventoryInfoID,
			A1.BIN_LogicInventoryInfoID,
			0 AS hQuantity,
			0 AS hDinQuantity,
			0 AS hDoutQuantity,		
			0 AS hinQuantity,		
			0 AS houtQuantity,		
			0 AS inQuantity1,		
			0 AS inQuantity2,		
			0 AS inQuantity3,		
			0 AS inQuantity4,		
			0 AS inQuantity5,		
			ISNULL(A1.Quantity,0) AS inQuantity6,
			0 AS inQuantity7,
			0 AS inQuantity8,
			0 AS outQuantity1,		
			0 AS outQuantity2,		
			0 AS outQuantity3,		
			0 AS outQuantity4,		
			0 AS outQuantity5,		
			0 AS outQuantity6,
			0 AS outQuantity7,
			0 AS outQuantity8,
			0 AS outQuantity9,
			0 AS outQuantity10,
			0 AS outQuantity11	
		FROM			
			Inventory.BIN_ProductInOut H WITH(NOLOCK)		
			JOIN Inventory.BIN_ProductInOutDetail A1 WITH(NOLOCK)	
			ON(H.BIN_ProductInOutID = A1.BIN_ProductInOutID
				AND A1.StockType = '0'
				AND A1.ValidFlag = '1')
		]]>
		<isNotEmpty property="productId">	
			JOIN Basis.BIN_ProductVendor T WITH(NOLOCK)
			ON(A1.BIN_ProductVendorID = T.BIN_ProductVendorID
				AND T.BIN_ProductID = #productId#
				AND T.ValidFlag = #validFlag#)
		</isNotEmpty>
		<![CDATA[
		WHERE			
			H.StockInOutDate >= CONVERT(date,#startDate#)	
			AND H.StockInOutDate <= CONVERT(date,#endDate#)	
			AND (H.TradeType = 'SR' OR H.TradeType = 'NS')
			AND H.ValidFlag = '1'		
		]]>
		<isNotEmpty prepend="AND" property="prtVendorId">	
			A1.BIN_ProductVendorID = #prtVendorId#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="depotId">	
			A1.BIN_InventoryInfoID = #depotId#
		</isNotEmpty>
		<isNotEmpty property="lgcInventoryId" prepend="AND">
			A1.BIN_LogicInventoryInfoID = #lgcInventoryId#
		</isNotEmpty>
	</sql>
	<!-- 取得产品本期销移入变化SQL -->
	<sql id="ProStockin7SQL">
		<![CDATA[
		SELECT			
			A1.BIN_InventoryInfoID,
			A1.BIN_LogicInventoryInfoID,
			0 AS hQuantity,
			0 AS hDinQuantity,
			0 AS hDoutQuantity,		
			0 AS hinQuantity,		
			0 AS houtQuantity,		
			0 AS inQuantity1,		
			0 AS inQuantity2,		
			0 AS inQuantity3,		
			0 AS inQuantity4,		
			0 AS inQuantity5,		
			0 AS inQuantity6,
			ISNULL(A1.Quantity,0) AS inQuantity7,
			0 AS inQuantity8,	
			0 AS outQuantity1,		
			0 AS outQuantity2,		
			0 AS outQuantity3,		
			0 AS outQuantity4,		
			0 AS outQuantity5,		
			0 AS outQuantity6,
			0 AS outQuantity7,
			0 AS outQuantity8,
			0 AS outQuantity9,
			0 AS outQuantity10,
			0 AS outQuantity11
		FROM			
			Inventory.BIN_ProductInOut H WITH(NOLOCK)		
			JOIN Inventory.BIN_ProductInOutDetail A1 WITH(NOLOCK)	
			ON(H.BIN_ProductInOutID = A1.BIN_ProductInOutID
				AND A1.StockType = '0'
				AND A1.ValidFlag = '1')
		]]>
		<isNotEmpty property="productId">	
			JOIN Basis.BIN_ProductVendor T WITH(NOLOCK)
			ON(A1.BIN_ProductVendorID = T.BIN_ProductVendorID
				AND T.BIN_ProductID = #productId#
				AND T.ValidFlag = #validFlag#)
		</isNotEmpty>
		<![CDATA[
		WHERE			
			H.StockInOutDate >= CONVERT(date,#startDate#)	
			AND H.StockInOutDate <= CONVERT(date,#endDate#)	
			AND H.TradeType = 'MV'
			AND H.ValidFlag = '1'		
		]]>
		<isNotEmpty prepend="AND" property="prtVendorId">	
			A1.BIN_ProductVendorID = #prtVendorId#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="depotId">	
			A1.BIN_InventoryInfoID = #depotId#
		</isNotEmpty>
		<isNotEmpty property="lgcInventoryId" prepend="AND">
			A1.BIN_LogicInventoryInfoID = #lgcInventoryId#
		</isNotEmpty>
	</sql>
	<!-- 提货入出库 -->
	<sql id="ProStockin8SQL">
		<![CDATA[
		SELECT			
			A1.BIN_InventoryInfoID,
			A1.BIN_LogicInventoryInfoID,
			0 AS hQuantity,
			0 AS hDinQuantity,
			0 AS hDoutQuantity,		
			0 AS hinQuantity,		
			0 AS houtQuantity,		
			0 AS inQuantity1,		
			0 AS inQuantity2,		
			0 AS inQuantity3,		
			0 AS inQuantity4,		
			0 AS inQuantity5,		
			0 AS inQuantity6,
			0 AS inQuantity7,
			ISNULL(A1.Quantity,0) AS inQuantity8,
			0 AS outQuantity1,		
			0 AS outQuantity2,		
			0 AS outQuantity3,		
			0 AS outQuantity4,		
			0 AS outQuantity5,		
			0 AS outQuantity6,
			0 AS outQuantity7,
			0 AS outQuantity8,
			0 AS outQuantity9,
			0 AS outQuantity10,
			0 AS outQuantity11	
		FROM			
			Inventory.BIN_ProductInOut H WITH(NOLOCK)		
			JOIN Inventory.BIN_ProductInOutDetail A1 WITH(NOLOCK)	
			ON(H.BIN_ProductInOutID = A1.BIN_ProductInOutID
				AND A1.StockType = '0'
				AND A1.ValidFlag = '1')
		]]>
		<isNotEmpty property="productId">	
			JOIN Basis.BIN_ProductVendor T WITH(NOLOCK)
			ON(A1.BIN_ProductVendorID = T.BIN_ProductVendorID
				AND T.BIN_ProductID = #productId#
				AND T.ValidFlag = #validFlag#)
		</isNotEmpty>
		<![CDATA[
		WHERE			
			H.StockInOutDate >= CONVERT(date,#startDate#)	
			AND H.StockInOutDate <= CONVERT(date,#endDate#)
			AND (H.TradeType = 'DG' OR H.TradeType = 'RG')
			AND H.ValidFlag = '1'		
		]]>
		<isNotEmpty prepend="AND" property="prtVendorId">	
			A1.BIN_ProductVendorID = #prtVendorId#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="depotId">	
			A1.BIN_InventoryInfoID = #depotId#
		</isNotEmpty>
		<isNotEmpty property="lgcInventoryId" prepend="AND">
			A1.BIN_LogicInventoryInfoID = #lgcInventoryId#
		</isNotEmpty>
	</sql>
	<sql id="getProProductSQL">
		
			<![CDATA[
			SELECT
				A.UnitCode AS unitCode,
				A.ModuleCode AS moduleCode,
				A.SaleUnit AS saleUnit,
				A.Spec AS spec,
			]]>
			<dynamic>
				<isNotEmpty property="prtVendorId">
					B.BarCode AS barCode,
				</isNotEmpty>
				<isNotEmpty property="language">
					<isEqual property="language" compareValue="en_US">
						A.NameForeign AS nameTotal
					</isEqual>
					<isEqual property="language" compareValue="zh_CN">	
						A.NameTotal AS nameTotal
					</isEqual>								
				</isNotEmpty>
				<isEmpty property="language">
					A.NameTotal AS nameTotal
				</isEmpty>
			</dynamic>
			<![CDATA[FROM Basis.BIN_Product A]]>
			<isNotEmpty property="prtVendorId">
				JOIN Basis.BIN_ProductVendor B	
				ON(A.BIN_ProductID = B.BIN_ProductID 
				AND B.BIN_ProductVendorID = #prtVendorId#)
			</isNotEmpty>
			<isEmpty property="prtVendorId">
			<![CDATA[WHERE A.BIN_ProductID = #productId#]]>
		</isEmpty>
	</sql>
	<!-- 取得库存记录详细  -->
    <sql id="getDetailSQL">
    	<![CDATA[SELECT
    		T0.BIN_InventoryInfoID,
			T0.BIN_LogicInventoryInfoID,
			SUM(CONVERT(BIGINT,T0.inQuantity1)) AS inQuantity1,
			SUM(CONVERT(BIGINT,T0.inQuantity2)) AS inQuantity2,
			SUM(CONVERT(BIGINT,T0.inQuantity3)) AS inQuantity3,
			SUM(CONVERT(BIGINT,T0.inQuantity4)) AS inQuantity4,
			SUM(CONVERT(BIGINT,T0.inQuantity5)) AS inQuantity5,
			SUM(CONVERT(BIGINT,T0.inQuantity6)) AS inQuantity6,
			SUM(CONVERT(BIGINT,T0.inQuantity7)) AS inQuantity7,
			SUM(CONVERT(BIGINT,T0.inQuantity8)) AS inQuantity8,
			SUM(CONVERT(BIGINT,T0.outQuantity1)) AS outQuantity1,
			SUM(CONVERT(BIGINT,T0.outQuantity2)) AS outQuantity2,
			SUM(CONVERT(BIGINT,T0.outQuantity3)) AS outQuantity3,
			SUM(CONVERT(BIGINT,T0.outQuantity4)) AS outQuantity4,
			SUM(CONVERT(BIGINT,T0.outQuantity5)) AS outQuantity5,
			SUM(CONVERT(BIGINT,T0.outQuantity6)) AS outQuantity6,
			SUM(CONVERT(BIGINT,T0.outQuantity7)) AS outQuantity7,
			SUM(CONVERT(BIGINT,T0.outQuantity8)) AS outQuantity8,
			SUM(CONVERT(BIGINT,T0.outQuantity9)) AS outQuantity9,
			SUM(CONVERT(BIGINT,T0.outQuantity10)) AS outQuantity10,
			SUM(CONVERT(BIGINT,T0.outQuantity11)) AS outQuantity11,
		]]>	
		<isNotEmpty property="flagB" >
		<![CDATA[		
			SUM(CONVERT(BIGINT,T0.hQuantity) + (CONVERT(BIGINT,T0.hDinQuantity) - CONVERT(BIGINT,T0.hDoutQuantity)) + (CONVERT(BIGINT,T0.hinQuantity)-CONVERT(BIGINT,T0.houtQuantity)) * #flag#) AS endQuantity,
			SUM(CONVERT(BIGINT,T0.hQuantity) + (CONVERT(BIGINT,T0.hDinQuantity) - CONVERT(BIGINT,T0.hDoutQuantity)) + (CONVERT(BIGINT,T0.hinQuantity)-CONVERT(BIGINT,T0.houtQuantity)) * #flag#
				-(CONVERT(BIGINT,T0.inQuantity1)+CONVERT(BIGINT,T0.inQuantity2)+CONVERT(BIGINT,T0.inQuantity3)+CONVERT(BIGINT,T0.inQuantity4)
					+CONVERT(BIGINT,T0.inQuantity5)+CONVERT(BIGINT,T0.inQuantity6)+CONVERT(BIGINT,T0.inQuantity7)+CONVERT(BIGINT,T0.inQuantity8)
					-CONVERT(BIGINT,T0.outQuantity1)-CONVERT(BIGINT,T0.outQuantity2)-CONVERT(BIGINT,T0.outQuantity3)
					-CONVERT(BIGINT,T0.outQuantity4)-CONVERT(BIGINT,T0.outQuantity5)-CONVERT(BIGINT,T0.outQuantity6)
					-CONVERT(BIGINT,T0.outQuantity7)-CONVERT(BIGINT,T0.outQuantity8)-CONVERT(BIGINT,T0.outQuantity9)-CONVERT(BIGINT,T0.outQuantity10)-CONVERT(BIGINT,T0.outQuantity11))
			) AS startQuantity
		]]>		
		</isNotEmpty>
		<isEmpty property="flagB" >
		<![CDATA[		
			SUM(CONVERT(BIGINT,T0.hQuantity) + (CONVERT(BIGINT,T0.hDinQuantity) - CONVERT(BIGINT,T0.hDoutQuantity)) + (CONVERT(BIGINT,T0.hinQuantity)-CONVERT(BIGINT,T0.houtQuantity)) * #flag#) AS startQuantity,
			SUM(CONVERT(BIGINT,T0.hQuantity) + (CONVERT(BIGINT,T0.hDinQuantity) - CONVERT(BIGINT,T0.hDoutQuantity)) + (CONVERT(BIGINT,T0.hinQuantity)-CONVERT(BIGINT,T0.houtQuantity)) * #flag#
				+(CONVERT(BIGINT,T0.inQuantity1)+CONVERT(BIGINT,T0.inQuantity2)+CONVERT(BIGINT,T0.inQuantity3)+CONVERT(BIGINT,T0.inQuantity4)
					+CONVERT(BIGINT,T0.inQuantity5)+CONVERT(BIGINT,T0.inQuantity6)+CONVERT(BIGINT,T0.inQuantity7)+CONVERT(BIGINT,T0.inQuantity8)
					-CONVERT(BIGINT,T0.outQuantity1)-CONVERT(BIGINT,T0.outQuantity2)-CONVERT(BIGINT,T0.outQuantity3)
					-CONVERT(BIGINT,T0.outQuantity4)-CONVERT(BIGINT,T0.outQuantity5)-CONVERT(BIGINT,T0.outQuantity6)
					-CONVERT(BIGINT,T0.outQuantity7)-CONVERT(BIGINT,T0.outQuantity8)-CONVERT(BIGINT,T0.outQuantity9)-CONVERT(BIGINT,T0.outQuantity10)-CONVERT(BIGINT,T0.outQuantity11))
			) AS endQuantity
		]]>		
		</isEmpty>
		<![CDATA[ FROM ( ]]>
		<include refid="BINOLPTRPS12.ProStockhistorySQL" />
		<![CDATA[ UNION ALL ]]>
		<include refid="BINOLPTRPS12.ProStockhDinSQL" />
		<![CDATA[ UNION ALL ]]>
		<include refid="BINOLPTRPS12.ProStockhDoutSQL" />
		<![CDATA[ UNION ALL ]]>
		<include refid="BINOLPTRPS12.ProStockhinSQL" />
		<![CDATA[ UNION ALL ]]>
		<include refid="BINOLPTRPS12.ProStockhoutSQL" />
		<![CDATA[ UNION ALL ]]>
		<include refid="BINOLPTRPS12.ProStockin1SQL" />
		<![CDATA[ UNION ALL ]]>
		<include refid="BINOLPTRPS12.ProStockin2SQL" />
		<![CDATA[ UNION ALL ]]>
		<include refid="BINOLPTRPS12.ProStockin3SQL" />
		<![CDATA[ UNION ALL ]]>
		<include refid="BINOLPTRPS12.ProStockin4SQL" />
		<![CDATA[ UNION ALL ]]>
		<include refid="BINOLPTRPS12.ProStockin5SQL" />
		<![CDATA[ UNION ALL ]]>
		<include refid="BINOLPTRPS12.ProStockin6SQL" />
		<![CDATA[ UNION ALL ]]>
		<include refid="BINOLPTRPS12.ProStockin7SQL" />
		<![CDATA[ UNION ALL ]]>
		<include refid="BINOLPTRPS12.ProStockin8SQL" />
		<![CDATA[ UNION ALL ]]>
		<include refid="BINOLPTRPS12.ProStockout1SQL" />
		<![CDATA[ UNION ALL ]]>
		<include refid="BINOLPTRPS12.ProStockout2SQL" />
		<![CDATA[ UNION ALL ]]>
		<include refid="BINOLPTRPS12.ProStockout3SQL" />
		<![CDATA[ UNION ALL ]]>
		<include refid="BINOLPTRPS12.ProStockout4SQL" />
		<![CDATA[ UNION ALL ]]>
		<include refid="BINOLPTRPS12.ProStockout5SQL" />
		<![CDATA[ UNION ALL ]]>
		<include refid="BINOLPTRPS12.ProStockout6SQL" />
		<![CDATA[ UNION ALL ]]>
		<include refid="BINOLPTRPS12.ProStockout7SQL" />
		<![CDATA[ UNION ALL ]]>
		<include refid="BINOLPTRPS12.ProStockout8SQL" />
		<![CDATA[ UNION ALL ]]>
		<include refid="BINOLPTRPS12.ProStockout9SQL" />
		<![CDATA[ UNION ALL ]]>
		<include refid="BINOLPTRPS12.ProStockout10SQL" />
		<![CDATA[ UNION ALL ]]>
		<include refid="BINOLPTRPS12.ProStockout11SQL" />
		<![CDATA[  ) T0
				JOIN T99 ON(T0.BIN_InventoryInfoID = T99.BIN_InventoryInfoID)
			GROUP BY
				T0.BIN_InventoryInfoID,
			    T0.BIN_LogicInventoryInfoID
		]]>						
    </sql>
    <sql id="getProStockDetailsSQL">
    <![CDATA[SELECT]]>
		<dynamic>
			<isNotEmpty property="language">
				<isEqual property="language" compareValue="en_US">
					'('+O.DepartCode+')' + O.NameForeign AS departName,
					A1.DepotNameEN AS inventoryName,
					A2.InventoryNameEN AS lgcInventoryName,
				</isEqual>
				<isEqual property="language" compareValue="zh_CN">	
					'('+O.DepartCode+')' + O.DepartName AS departName,
					A1.DepotNameCN AS inventoryName,
					A2.InventoryNameCN AS lgcInventoryName,
				</isEqual>								
			</isNotEmpty>
			<isEmpty property="language">
				'('+O.DepartCode+')' + O.DepartName AS departName,
				A1.DepotNameCN AS inventoryName,
				A2.InventoryNameCN AS lgcInventoryName,
			</isEmpty>
		</dynamic>
		<![CDATA[T1.* FROM(]]>
    	<include refid="BINOLPTRPS12.getDetailSQL" />
    	<![CDATA[)T1
    		JOIN Basis.BIN_DepotInfo A1	
			ON(T1.BIN_InventoryInfoID = A1.BIN_DepotInfoID)
			LEFT JOIN Basis.BIN_Organization O
			ON(A1.BIN_OrganizationID = O.BIN_OrganizationID)
			LEFT JOIN Basis.BIN_LogicInventory A2
			ON(T1.BIN_LogicInventoryInfoID = A2.BIN_LogicInventoryInfoID)
		]]>	
    </sql>
    <!-- 取得产品信息  -->
	<select id="getProProduct" parameterClass="java.util.HashMap" resultClass="java.util.HashMap" remapResults="true">
		<include refid="BINOLPTRPS12.getProProductSQL" />
	</select>
	<!-- 取得产品条码信息  -->
	<select id="getBarCodeList" parameterClass="java.util.HashMap" resultClass="java.lang.String">
		<![CDATA[
		SELECT
			BarCode
		FROM		
			Basis.BIN_ProductVendor
		WHERE
			BIN_ProductID = #productId#
			AND ValidFlag = #validFlag#
		]]>
	</select>
    <!-- 取得库存记录详细  -->
    <select id="getProStockDetails" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
    	<include refid="BINOLCMINC99.getInventoryList" />
    	<include refid="BINOLPTRPS12.getProStockDetailsSQL" />
    </select>
	
	    <!-- 取得库存记录详细单据  -->
    <select id="getdetailed" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
	<![CDATA[
			SELECT
					A.TradeNoIF,
					C.EmployeeCode,
					C.EmployeeName,
					A.StockInOutDate,
					B.Quantity,
					B.StockType
			FROM 
					Inventory.BIN_ProductInOut A WITH(NOLOCK)
					JOIN Inventory.BIN_ProductInOutDetail B WITH(NOLOCK)
					ON(A.BIN_ProductInOutID = B.BIN_ProductInOutID)
			]]>
			<isNotEmpty property="productId">	
				JOIN Basis.BIN_ProductVendor T WITH(NOLOCK)
				ON(B.BIN_ProductVendorID = T.BIN_ProductVendorID
					AND T.BIN_ProductID = #productId#
					AND T.ValidFlag = #validFlag#)
			</isNotEmpty>
			<![CDATA[		
					LEFT JOIN Basis.BIN_Employee C
					ON(A.BIN_EmployeeID = C.BIN_EmployeeID)
			Where
				A.StockInOutDate >= #startDate# AND
				A.StockInOutDate <= #endDate#
		]]>
		<isNotEmpty prepend="AND" property="prtVendorId">	
			B.BIN_ProductVendorID = #prtVendorId#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="inventoryInfoID">	
			B.BIN_InventoryInfoID = #inventoryInfoID#
		</isNotEmpty>
		<isNotEmpty property="logicInventoryInfoID" prepend="AND">
			B.BIN_LogicInventoryInfoID = #logicInventoryInfoID#
		</isNotEmpty>	
		<isEqual  property="tradeType" compareValue="NS" prepend="AND">
				A.TradeType in ('NS','SR')
			
		</isEqual>	
		
		<isEqual  property="tradeType" compareValue="SR" prepend="AND">
				A.TradeType in ('NS','SR')
				
		</isEqual>	
        <isNotEqual property="tradeType" compareValue="SR" prepend="AND">
        	A.TradeType=#tradeType#
           
         </isNotEqual>
		    <isNotEqual property="tradeType" compareValue="NS" prepend="AND">
        	A.TradeType=#tradeType#
            
         </isNotEqual>
         <isEqual  property="tradeType" compareValue="DG" prepend="AND">
				A.TradeType in ('DG','RG')
			
		</isEqual>	
		
		<isEqual  property="tradeType" compareValue="RG" prepend="AND">
				A.TradeType in ('DG','RG')
				
		</isEqual>	
        <isNotEqual property="tradeType" compareValue="DG" prepend="AND">
        	A.TradeType=#tradeType#
           
         </isNotEqual>
		    <isNotEqual property="tradeType" compareValue="RG" prepend="AND">
        	A.TradeType=#tradeType#
            
         </isNotEqual>
		 <isNotEmpty property="stockType" prepend="AND">
				B.StockType=#stockType#
		</isNotEmpty>
		ORDER BY A.StockInOutDate desc
    </select>
</sqlMap>